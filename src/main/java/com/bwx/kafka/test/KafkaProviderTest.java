package com.bwx.kafka.test;

import com.bwx.config.Constant;
import org.apache.kafka.clients.producer.KafkaProducer;
import org.apache.kafka.clients.producer.Producer;
import org.apache.kafka.clients.producer.ProducerRecord;

import java.net.ProxySelector;
import java.util.Date;
import java.util.Properties;

public class KafkaProviderTest {
    public static void main(String args[]) {

        String kafka_host = Constant.kafka_host;
        Properties props = new Properties();
        props.put("bootstrap.servers", kafka_host);
        props.put("acks", "all");//所有实例确认
        props.put("batch.size", 16384);
        props.put("retries", 0);
        props.put("linger.ms", 1);
        props.put("buffer.memory", 33554432);
        props.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer");
        props.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer");

        sendMessage(props);
        System.out.println("---------");
    }
    private static void sendMessage(Properties props) {
        int i = 1;
        Producer<String, String> producer = new KafkaProducer<>(props);
        String topics = "ocf_12h_tourism";

        while (i >= 0) {
            Date date = new Date();
//            String value = "[{\"sunrise\":\"01:46\",\"date\":\"20181219\",\"daynum\":1,\"sunset\":\"15:16\"},{\"sunrise\":\"01:46\",\"date\":\"20181220\",\"daynum\":2,\"sunset\":\"15:17\"},{\"sunrise\":\"01:47\",\"date\":\"20181221\",\"daynum\":3,\"sunset\":\"15:17\"},{\"sunrise\":\"01:47\",\"date\":\"20181222\",\"daynum\":4,\"sunset\":\"15:18\"},{\"sunrise\":\"01:48\",\"date\":\"20181223\",\"daynum\":5,\"sunset\":\"15:18\"},{\"sunrise\":\"01:48\",\"date\":\"20181224\",\"daynum\":6,\"sunset\":\"15:19\"},{\"sunrise\":\"01:49\",\"date\":\"20181225\",\"daynum\":7,\"sunset\":\"15:19\"}]";
            String value = "[{\"ff\":\"7.0\",\"dd\":\"180.0\",\"rain\":\"0.0\",\"temp\":\"20.5\",\"tmax\":\"26.0\",\"tmin\":\"14.4\",\"vti\":\"12\",\"rhmin\":\"19.4\",\"wd\":\"4.0\",\"cloud\":\"79.9\",\"head\":\"54511   999.9   999.9   999.9      2019061500  2019061508    8.00  2019061508  2019061508   30\",\"fc_time\":\"2019061520\",\"rh\":\"20.5\",\"weather\":\"1.0\",\"rhmax\":\"33.5\",\"ws\":\"1.0\"},{\"ff\":\"4.5\",\"dd\":\"180.0\",\"rain\":\"0.0\",\"temp\":\"14.6\",\"tmax\":\"19.8\",\"tmin\":\"12.0\",\"vti\":\"24\",\"rhmin\":\"42.6\",\"wd\":\"4.0\",\"cloud\":\"79.9\",\"fc_time\":\"2019061608\",\"rh\":\"47.8\",\"weather\":\"1.0\",\"rhmax\":\"62.1\",\"ws\":\"0.0\"},{\"ff\":\"7.0\",\"dd\":\"182.4\",\"rain\":\"0.0\",\"temp\":\"18.6\",\"tmax\":\"26.0\",\"tmin\":\"15.2\",\"vti\":\"36\",\"rhmin\":\"22.8\",\"wd\":\"4.0\",\"cloud\":\"10.0\",\"fc_time\":\"2019061620\",\"rh\":\"37.0\",\"weather\":\"0.0\",\"rhmax\":\"37.0\",\"ws\":\"1.0\"},{\"ff\":\"4.5\",\"dd\":\"151.2\",\"rain\":\"0.0\",\"temp\":\"13.8\",\"tmax\":\"19.9\",\"tmin\":\"12.0\",\"vti\":\"48\",\"rhmin\":\"45.4\",\"wd\":\"3.0\",\"cloud\":\"10.0\",\"fc_time\":\"2019061708\",\"rh\":\"53.8\",\"weather\":\"0.0\",\"rhmax\":\"66.5\",\"ws\":\"0.0\"},{\"ff\":\"4.5\",\"dd\":\"225.0\",\"rain\":\"0.0\",\"temp\":\"24.5\",\"tmax\":\"27.0\",\"tmin\":\"16.0\",\"vti\":\"60\",\"rhmin\":\"36.5\",\"wd\":\"5.0\",\"cloud\":\"10.0\",\"fc_time\":\"2019061720\",\"rh\":\"44.6\",\"weather\":\"0.0\",\"rhmax\":\"44.6\",\"ws\":\"0.0\"},{\"ff\":\"7.0\",\"dd\":\"0.0\",\"rain\":\"0.0\",\"temp\":\"17.4\",\"tmax\":\"23.0\",\"tmin\":\"16.1\",\"vti\":\"72\",\"rhmin\":\"33.2\",\"wd\":\"8.0\",\"cloud\":\"79.9\",\"fc_time\":\"2019061808\",\"rh\":\"34.2\",\"weather\":\"1.0\",\"rhmax\":\"67.6\",\"ws\":\"1.0\"},{\"ff\":\"9.5\",\"dd\":\"45.0\",\"rain\":\"0.0\",\"temp\":\"17.8\",\"tmax\":\"23.0\",\"tmin\":\"17.1\",\"vti\":\"84\",\"rhmin\":\"23.7\",\"wd\":\"1.0\",\"cloud\":\"32.3\",\"fc_time\":\"2019061820\",\"rh\":\"33.8\",\"weather\":\"1.0\",\"rhmax\":\"33.8\",\"ws\":\"2.0\"},{\"ff\":\"4.5\",\"dd\":\"177.5\",\"rain\":\"0.0\",\"temp\":\"11.2\",\"tmax\":\"17.2\",\"tmin\":\"11.0\",\"vti\":\"96\",\"rhmin\":\"65.4\",\"wd\":\"4.0\",\"cloud\":\"79.9\",\"fc_time\":\"2019061908\",\"rh\":\"65.4\",\"weather\":\"1.0\",\"rhmax\":\"74.5\",\"ws\":\"0.0\"},{\"ff\":\"4.5\",\"dd\":\"173.4\",\"rain\":\"0.0\",\"temp\":\"15.7\",\"tmax\":\"19.0\",\"tmin\":\"13.2\",\"vti\":\"108\",\"rhmin\":\"69.5\",\"wd\":\"4.0\",\"cloud\":\"79.9\",\"fc_time\":\"2019061920\",\"rh\":\"69.5\",\"weather\":\"1.0\",\"rhmax\":\"86.2\",\"ws\":\"0.0\"},{\"ff\":\"4.5\",\"dd\":\"176.4\",\"rain\":\"0.0\",\"temp\":\"12.1\",\"tmax\":\"13.4\",\"tmin\":\"9.0\",\"vti\":\"120\",\"rhmin\":\"36.6\",\"wd\":\"4.0\",\"cloud\":\"1.1\",\"fc_time\":\"2019062008\",\"rh\":\"49.8\",\"weather\":\"0.0\",\"rhmax\":\"99.5\",\"ws\":\"0.0\"},{\"ff\":\"7.0\",\"dd\":\"191.1\",\"rain\":\"0.0\",\"temp\":\"17.3\",\"tmax\":\"22.0\",\"tmin\":\"13.0\",\"vti\":\"132\",\"rhmin\":\"54.6\",\"wd\":\"4.0\",\"cloud\":\"79.9\",\"fc_time\":\"2019062020\",\"rh\":\"56.5\",\"weather\":\"1.0\",\"rhmax\":\"56.5\",\"ws\":\"1.0\"},{\"ff\":\"4.5\",\"dd\":\"180.0\",\"rain\":\"0.0\",\"temp\":\"16.0\",\"tmax\":\"16.0\",\"tmin\":\"12.0\",\"vti\":\"144\",\"rhmin\":\"43.8\",\"wd\":\"4.0\",\"cloud\":\"79.9\",\"fc_time\":\"2019062108\",\"rh\":\"54.5\",\"weather\":\"1.0\",\"rhmax\":\"71.8\",\"ws\":\"0.0\"},{\"ff\":\"4.5\",\"dd\":\"55.9\",\"rain\":\"0.0\",\"temp\":\"14.9\",\"tmax\":\"18.0\",\"tmin\":\"13.4\",\"vti\":\"156\",\"rhmin\":\"41.7\",\"wd\":\"1.0\",\"cloud\":\"38.5\",\"fc_time\":\"2019062120\",\"rh\":\"55.1\",\"weather\":\"1.0\",\"rhmax\":\"55.1\",\"ws\":\"0.0\"},{\"ff\":\"4.5\",\"dd\":\"45.0\",\"rain\":\"0.0\",\"temp\":\"12.8\",\"tmax\":\"14.3\",\"tmin\":\"10.0\",\"vti\":\"168\",\"rhmin\":\"68.8\",\"wd\":\"1.0\",\"cloud\":\"64.0\",\"fc_time\":\"2019062208\",\"rh\":\"68.8\",\"weather\":\"1.0\",\"rhmax\":\"85.3\",\"ws\":\"0.0\"},{\"ff\":\"3.3\",\"dd\":\"183.9\",\"rain\":\"0.0\",\"temp\":\"18.4\",\"tmax\":\"24.0\",\"tmin\":\"13.2\",\"vti\":\"180\",\"rhmin\":\"45.8\",\"wd\":\"4.0\",\"cloud\":\"72.4\",\"fc_time\":\"2019062220\",\"rh\":\"57.6\",\"weather\":\"1.0\",\"rhmax\":\"57.6\",\"ws\":\"0.0\"},{\"ff\":\"1.9\",\"dd\":\"15.3\",\"rain\":\"0.0\",\"temp\":\"16.2\",\"tmax\":\"19.1\",\"tmin\":\"13.2\",\"vti\":\"192\",\"rhmin\":\"75.0\",\"wd\":\"8.0\",\"cloud\":\"63.0\",\"fc_time\":\"2019062308\",\"rh\":\"80.3\",\"weather\":\"1.0\",\"rhmax\":\"80.3\",\"ws\":\"0.0\"},{\"ff\":\"3.2\",\"dd\":\"14.8\",\"rain\":\"0.0\",\"temp\":\"18.0\",\"tmax\":\"23.8\",\"tmin\":\"14.7\",\"vti\":\"204\",\"rhmin\":\"25.6\",\"wd\":\"8.0\",\"cloud\":\"19.4\",\"fc_time\":\"2019062320\",\"rh\":\"55.9\",\"weather\":\"0.0\",\"rhmax\":\"55.9\",\"ws\":\"0.0\"},{\"ff\":\"3.9\",\"dd\":\"1.2\",\"rain\":\"1.5\",\"temp\":\"16.2\",\"tmax\":\"18.9\",\"tmin\":\"13.4\",\"vti\":\"216\",\"rhmin\":\"34.0\",\"wd\":\"8.0\",\"cloud\":\"100.0\",\"fc_time\":\"2019062408\",\"rh\":\"78.9\",\"weather\":\"301.0\",\"rhmax\":\"78.9\",\"ws\":\"0.0\"},{\"ff\":\"3.1\",\"dd\":\"131.5\",\"rain\":\"0.6\",\"temp\":\"14.5\",\"tmax\":\"21.1\",\"tmin\":\"14.3\",\"vti\":\"228\",\"rhmin\":\"14.6\",\"wd\":\"3.0\",\"cloud\":\"100.0\",\"fc_time\":\"2019062420\",\"rh\":\"50.0\",\"weather\":\"301.0\",\"rhmax\":\"50.0\",\"ws\":\"0.0\"},{\"ff\":\"1.8\",\"dd\":\"25.4\",\"rain\":\"0.0\",\"temp\":\"13.6\",\"tmax\":\"14.5\",\"tmin\":\"8.4\",\"vti\":\"240\",\"rhmin\":\"38.5\",\"wd\":\"1.0\",\"cloud\":\"5.6\",\"fc_time\":\"2019062508\",\"rh\":\"40.9\",\"weather\":\"0.0\",\"rhmax\":\"40.9\",\"ws\":\"0.0\"},{\"ff\":\"3.1\",\"dd\":\"178.5\",\"rain\":\"0.0\",\"temp\":\"17.0\",\"tmax\":\"21.9\",\"tmin\":\"13.6\",\"vti\":\"252\",\"rhmin\":\"18.2\",\"wd\":\"4.0\",\"cloud\":\"47.9\",\"fc_time\":\"2019062520\",\"rh\":\"18.2\",\"weather\":\"1.0\",\"rhmax\":\"18.5\",\"ws\":\"0.0\"},{\"ff\":\"2.5\",\"dd\":\"194.2\",\"rain\":\"0.0\",\"temp\":\"13.5\",\"tmax\":\"17.0\",\"tmin\":\"9.8\",\"vti\":\"264\",\"rhmin\":\"22.1\",\"wd\":\"4.0\",\"cloud\":\"96.6\",\"fc_time\":\"2019062608\",\"rh\":\"22.1\",\"weather\":\"2.0\",\"rhmax\":\"68.3\",\"ws\":\"0.0\"},{\"ff\":\"4.8\",\"dd\":\"211.1\",\"rain\":\"0.0\",\"temp\":\"18.5\",\"tmax\":\"23.4\",\"tmin\":\"13.5\",\"vti\":\"276\",\"rhmin\":\"21.0\",\"wd\":\"5.0\",\"cloud\":\"23.3\",\"fc_time\":\"2019062620\",\"rh\":\"21.0\",\"weather\":\"1.0\",\"rhmax\":\"36.4\",\"ws\":\"0.0\"},{\"ff\":\"3.9\",\"dd\":\"215.3\",\"rain\":\"0.0\",\"temp\":\"16.1\",\"tmax\":\"18.5\",\"tmin\":\"11.8\",\"vti\":\"288\",\"rhmin\":\"23.7\",\"wd\":\"5.0\",\"cloud\":\"19.7\",\"fc_time\":\"2019062708\",\"rh\":\"23.7\",\"weather\":\"0.0\",\"rhmax\":\"63.6\",\"ws\":\"0.0\"},{\"ff\":\"5.2\",\"dd\":\"251.5\",\"rain\":\"0.0\",\"temp\":\"22.8\",\"tmax\":\"30.3\",\"tmin\":\"16.1\",\"vti\":\"300\",\"rhmin\":\"22.7\",\"wd\":\"6.0\",\"cloud\":\"17.8\",\"fc_time\":\"2019062720\",\"rh\":\"24.1\",\"weather\":\"0.0\",\"rhmax\":\"24.1\",\"ws\":\"0.0\"},{\"ff\":\"3.3\",\"dd\":\"47.3\",\"rain\":\"0.0\",\"temp\":\"18.0\",\"tmax\":\"22.8\",\"tmin\":\"14.9\",\"vti\":\"312\",\"rhmin\":\"33.2\",\"wd\":\"1.0\",\"cloud\":\"56.5\",\"fc_time\":\"2019062808\",\"rh\":\"42.7\",\"weather\":\"1.0\",\"rhmax\":\"42.7\",\"ws\":\"0.0\"},{\"ff\":\"5.2\",\"dd\":\"99.3\",\"rain\":\"0.0\",\"temp\":\"19.0\",\"tmax\":\"25.6\",\"tmin\":\"18.0\",\"vti\":\"324\",\"rhmin\":\"28.9\",\"wd\":\"2.0\",\"cloud\":\"64.4\",\"fc_time\":\"2019062820\",\"rh\":\"28.9\",\"weather\":\"1.0\",\"rhmax\":\"41.7\",\"ws\":\"0.0\"},{\"ff\":\"6.0\",\"dd\":\"32.0\",\"rain\":\"0.0\",\"temp\":\"15.5\",\"tmax\":\"19.0\",\"tmin\":\"11.7\",\"vti\":\"336\",\"rhmin\":\"32.9\",\"wd\":\"1.0\",\"cloud\":\"90.7\",\"fc_time\":\"2019062908\",\"rh\":\"32.9\",\"weather\":\"2.0\",\"rhmax\":\"78.0\",\"ws\":\"1.0\"},{\"ff\":\"3.3\",\"dd\":\"199.3\",\"rain\":\"0.0\",\"temp\":\"19.9\",\"tmax\":\"25.0\",\"tmin\":\"15.5\",\"vti\":\"348\",\"rhmin\":\"23.8\",\"wd\":\"4.0\",\"cloud\":\"65.3\",\"fc_time\":\"2019062920\",\"rh\":\"25.8\",\"weather\":\"1.0\",\"rhmax\":\"25.8\",\"ws\":\"0.0\"},{\"ff\":\"3.3\",\"dd\":\"304.4\",\"rain\":\"0.0\",\"temp\":\"16.9\",\"tmax\":\"19.9\",\"tmin\":\"13.3\",\"vti\":\"360\",\"rhmin\":\"29.6\",\"wd\":\"7.0\",\"cloud\":\"99.3\",\"fc_time\":\"2019063008\",\"rh\":\"29.6\",\"weather\":\"2.0\",\"rhmax\":\"30.4\",\"ws\":\"0.0\"}]";

//            producer.send(new ProducerRecord<String, String>(topics, "key_" + i+"_"+date.getTime(), value));
            producer.send(new ProducerRecord<String, String>(topics,  "1010101000"+i+"A"+",2019071208,ex_0", value));
            try {
                if (i > 10) {
                    System.out.println(topics);
                    Thread.sleep(10000);
                    i=1;
                }
                i++;
            } catch (InterruptedException e) {
                e.printStackTrace();
            }

        }
        producer.close();
    }
}
